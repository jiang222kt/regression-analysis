# makefileと回帰分析の課題について
以下、makefileと回帰分析の課題でやったことを簡潔にまとめる。なお、makeするとバイナリファイルを格納するbinディレクトリを生成するようなmakefileを作ったので、以下のコマンドで実行することになる。

コンパイル:
```
make
```

実行:
```
cd bin
./hoge
```
make clean:
```
cd ..
make clean
```

## 課題1
- ペイントソフトのコードを複数のヘッダファイル、ソースファイルに分割し、makefileでコンパイルできるようにした。

## 課題2
- `data.csv`からデータを取得し、与えられた標高と山頂の平均気温を用いて最小二乗法を行い、それによって富士山頂の平均気温を推測した。富士山の標高は3776mとした。
- また、`data.csv`内のデータを、`qsort`を用いて標高の低いほうから高いほうへと並び替えて表示させた。
- `qsort`の際に比較対象(標高)がint型ではなくfloat型のため、以下のような関数を作り、並び替えるのに用いた。

```
int comp_alt(const void *x0, const void *x1)
{
    const Sample *p0 = (Sample *)x0;
    const Sample *p1 = (Sample *)x1;
    // "return p0->alt - p1->alt" dose not work! 
    // since p->alt is type of int!
    return p0->alt >= p1->alt ? 1: -1;
}
```

- 実行した結果、富士山の山頂はおよそ4℃となった。なお、ソートしたデータ、最急降下法を反復した回数、求まった線形回帰の回帰曲線の方程式も表示されるようにした。

## 課題3(発展課題)
発展課題として、ふたつのプログラムを作った。

### 一つ目(adv)
- 課題2では気温を求めるのに標高しか用いなかったが、緯度と経度も気温に関係するのではないかという思い、`data.csv`に緯度と経度という二つの要素を追加した`data-with-geo.csv`を用意して重回帰分析を行った。なお、緯度と経度は国土地理院のホームページを参考にした。

data-with-geo.csv:
```
//左から順に、地名、標高、気温、緯度、経度
Nozawa-onsen,   0.576,  22.3,   36.923, 138.441 
Iiyama,         0.313,  23.3,   36.852, 138.366
Nagano,         0.4182, 23.8,   36.649, 138.195
Oomachi,        0.784,  21.1,   36.503, 137.851
Sugadaira,      1.253,  18.5,   36.540, 138.322
Karuizawa,      0.9991, 19.5,   36.347, 138.593
Matsumoto,      0.610,  23.6,   36.238, 137.972
Nagawa,         1.068,  19.7,   36.072, 137.675
Suwa,           0.760,  22.7,   36.039, 138.114
Nobeyama,       1.350,  18.4,   35.949, 138.467
Ina,            0.633,  22.7,   35.827, 137.954
Nagiso,         0.560,  22.3,   35.599, 137.609
Iida,           0.5164, 23.9,   35.515, 137.822
Minami-shinano, 0.407,  23.5,   35.313, 137.930
```

- 緯度と経度を追加したので、次元は4次元となり、回帰曲線の方程式もそれにともなって4つの未知数を持つようになった。これを実行すると、富士山の山頂はおよそ10℃となった。

### 二つ目(adv2)
- 分析対象を探し、天気を題材に取り上げて気象庁の気象データの一部を使って日照時間の予測をしてみた。具体的には、一年の日照時間、降水量、気温、風速のデータをまとめたデータファイルを用意し、1970年から2018年までのデータを学習して回帰曲線を求め、それと2019年の降水量、気温、風速を用いて2019年の日照時間を推測した。
- `data-weather.csv`は2018年までのデータをまとめたもので、このデータを取得して回帰曲線を求めるようにしている。`data-to-2019.csv`は2019年のデータも含んだもので、ここの2019年の降水量、気温、風速を用いた。なお、参考元の気象庁の気象データは`気象データ（回帰分析用）.xlsx`というExcelファイルを同梱した。
- 最急降下法で更新の幅としてalphaという変数を用いるが、今までの課題に用いた値を用いると収束しないので、値を小さく設定した。
- 実行して見ると、2019年の日照時間の推定値は189.9hとなった。なお、実際の値は187.8hである。